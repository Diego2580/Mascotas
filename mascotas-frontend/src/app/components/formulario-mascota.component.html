<div class="container mt-4">
  <div class="row">
    <div class="col-md-8 offset-md-2">
      <div class="card">
        <div class="card-header">
          <h3 class="mb-0">{{ tituloFormulario }}</h3>
        </div>
        <div class="card-body">
          <!-- Mensajes de éxito y error -->
          <div *ngIf="error" class="alert alert-danger alert-dismissible fade show" role="alert">
            {{ error }}
            <button type="button" class="btn-close" (click)="error = null"></button>
          </div>

          <div *ngIf="exito" class="alert alert-success alert-dismissible fade show" role="alert">
            {{ exito }}
            <button type="button" class="btn-close" (click)="exito = null"></button>
          </div>

          <!-- Formulario -->
          <form [formGroup]="formulario" (ngSubmit)="onSubmit()" [ngClass]="{ 'was-validated': formulario.dirty }">
            <!-- Nombre -->
            <div class="mb-3">
              <label for="nombre" class="form-label">Nombre *</label>
              <input 
                type="text" 
                class="form-control"
                id="nombre"
                formControlName="nombre"
                placeholder="Ej: Max"
                [ngClass]="{ 'is-invalid': nombre?.invalid && nombre?.touched }">
              <div class="invalid-feedback" *ngIf="nombre?.invalid && nombre?.touched">
                <div *ngIf="nombre?.errors?.['required']">El nombre es obligatorio</div>
                <div *ngIf="nombre?.errors?.['minlength']">Mínimo 2 caracteres</div>
                <div *ngIf="nombre?.errors?.['maxlength']">Máximo 100 caracteres</div>
              </div>
            </div>

            <!-- Especie -->
            <div class="mb-3">
              <label for="especie" class="form-label">Especie *</label>
              <select 
                class="form-control" 
                id="especie"
                formControlName="especie"
                [ngClass]="{ 'is-invalid': especie?.invalid && especie?.touched }">
                <option value="">Selecciona una especie</option>
                <option *ngFor="let esp of especies" [value]="esp">{{ esp }}</option>
              </select>
              <div class="invalid-feedback" *ngIf="especie?.invalid && especie?.touched">
                La especie es obligatoria
              </div>
            </div>

            <!-- Edad -->
            <div class="mb-3">
              <label for="edad" class="form-label">Edad *</label>
              <input 
                type="number" 
                class="form-control"
                id="edad"
                formControlName="edad"
                placeholder="Ej: 5"
                min="0"
                max="100"
                [ngClass]="{ 'is-invalid': edad?.invalid && edad?.touched }">
              <div class="invalid-feedback" *ngIf="edad?.invalid && edad?.touched">
                <div *ngIf="edad?.errors?.['required']">La edad es obligatoria</div>
                <div *ngIf="edad?.errors?.['min']">La edad no puede ser negativa</div>
                <div *ngIf="edad?.errors?.['max']">La edad no puede ser mayor a 100</div>
              </div>
            </div>

            <!-- Dueño -->
            <div class="mb-3">
              <label for="dueno" class="form-label">Dueño *</label>
              <input 
                type="text" 
                class="form-control"
                id="dueno"
                formControlName="dueno"
                placeholder="Ej: Juan"
                [ngClass]="{ 'is-invalid': dueno?.invalid && dueno?.touched }">
              <div class="invalid-feedback" *ngIf="dueno?.invalid && dueno?.touched">
                <div *ngIf="dueno?.errors?.['required']">El dueño es obligatorio</div>
                <div *ngIf="dueno?.errors?.['minlength']">Minimo 2 caracteres</div>
                <div *ngIf="dueno?.errors?.['maxlength']">Maximo 100 caracteres</div>
              </div>
            </div>

            <!-- Botones -->
            <div class="d-flex gap-2">
              <button 
                type="submit" 
                class="btn btn-primary btn-lg"
                [disabled]="formulario.invalid || cargando">
                <span *ngIf="cargando" class="spinner-border spinner-border-sm me-2" role="status"></span>
                {{ tituloBoton }}
              </button>
              <button 
                type="button" 
                class="btn btn-secondary btn-lg"
                (click)="cancelar()">
                Cancelar
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
